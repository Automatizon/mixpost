import{r as _,k as U,G as q,N as F,a_ as re,I as O,b9 as ie,o as l,c as g,F as T,f as X,B,e as N,t as H,b as x,n as V,h as M,ck as ue,g as $,c3 as E,c1 as P,a as p,c7 as ce,u as o,w as v,j as Z,D as ee,_ as te,i as se}from"./app-CHaZqpGe.js";import{_ as L}from"./MediaFile-C2nLnsNa.js";import{_ as de,a as le}from"./SearchInput-6W0i14QN.js";import{l as Q,o as me}from"./helpers-CCXSf7je.js";import{_ as ne}from"./NoResult-DYf0HKIm.js";import{_ as ae}from"./Alert-BhHU7dhR.js";import{u as fe}from"./useNotifications-D56b7KE7.js";const W=(s="mixpost.media.fetchUploads",c={})=>{const{notify:f}=fe(),i=_("uploads"),k=U(()=>({uploads:"Upload",stock:"Stock Photos",gifs:"GIFs"})),d=_(!1),w=_(!1),S=_(!1),h=_(1),m=_([]),r=_(null),b=_(""),n=_([]),C=y=>{const e=n.value.findIndex(t=>t.id===y.id);e<0&&!y.hasOwnProperty("error")&&n.value.push(y),e>=0&&n.value.splice(e,1)},u=()=>{n.value=[]},a=y=>n.value.findIndex(t=>t.id===y.id)!==-1,I=(y=!0)=>{h.value&&(F.start(),axios.get(route(s,c),{params:{page:h.value,keyword:b.value}}).then(function(e){const t=e.data.links.next;t&&(h.value=e.data.links.next.split("?page=")[1]),t||(h.value=0),y||(m.value=e.data.data),y&&(m.value=[...m.value,...e.data.data])}).catch(()=>{f("error","Error retrieving media. Try again!")}).finally(()=>{F.done(),d.value=!0}))},j=(y,e)=>{w.value=!0,F.start(),axios.post(route("mixpost.media.download",c),{items:y,from:i.value}).then(t=>{e(t)}).catch(()=>{f("error","Error downloading media. Try again!")}).finally(()=>{w.value=!1,F.done(),F.remove()})},J=y=>{m.value=m.value.filter(e=>!y.includes(e.id))},A=(y,e)=>{S.value=!0,F.start(),axios.delete(route("mixpost.media.delete",c),{data:{items:y}}).then(()=>{e()}).catch(()=>{f("error","Error deleting media. Try again!")}).finally(()=>{S.value=!1,F.done(),F.remove()})},R=()=>{const y=new IntersectionObserver(e=>{e[0].isIntersecting&&I()});re(()=>{y.observe(r.value)})};return q(b,Q.debounce(()=>{h.value=1,I(!1)},300)),{activeTab:i,tabs:k,isLoaded:d,isDownloading:w,isDeleting:S,keyword:b,page:h,items:m,endlessPagination:r,selected:n,downloadExternal:j,deletePermanently:A,removeItems:J,createObserver:R,toggleSelect:C,deselectAll:u,isSelected:a}},ve="useandom-26T198340PX75pxJACKVERYMINDBUSHWOLF_GQZbfghjklqvwyzrict";let pe=(s=21)=>{let c="",f=crypto.getRandomValues(new Uint8Array(s));for(;s--;)c+=ve[f[s]&63];return c};const ge=["data-column"],z={__name:"Masonry",props:{items:{type:Array,required:!0},columns:{type:Number,default:3}},setup(s){const c=s,f=_(null),i=_([]),k=_(!1);O(()=>{m(),window.addEventListener("resize",d)}),ie(()=>{window.removeEventListener("resize",d)});const d=Q.debounce(()=>{i.value.length!==w().length&&m()},300),w=()=>{let r=c.columns;me().width<=768&&(r=2);const b=[];for(let n=0;n<r;n++)b.push({i:n,indexes:[]});return b},S=r=>{const b=r%i.value.length;i.value[b].indexes.push(r)},h=()=>{for(let r=0;r<c.items.length;r++)S(r)},m=()=>{k.value=!1,i.value.splice(0),i.value.push(...w()),k.value=!0,h()};return q(()=>c.items,()=>{m()}),(r,b)=>(l(),g("div",{class:V(["flex -m-1",{"opacity-0":!k.value}])},[(l(!0),g(T,null,X(i.value,(n,C)=>(l(),g("div",{class:"flex flex-col grow basis-0 px-1",key:C},[(l(!0),g(T,null,X(n.indexes,u=>(l(),g("div",{class:"py-1",key:u,ref_for:!0,ref:`item_${u}`},[B(r.$slots,"default",{item:s.items[u],index:u},()=>[N(H(s.items[u]),1)])]))),128)),x("div",{class:"grow -mt-20 pt-20 min-h-[100px] -z-10",ref_for:!0,ref_key:"bottomRef",ref:f,"data-column":C},null,8,ge)]))),128))],2))}},G={__name:"MediaSelectable",props:{active:{type:Boolean,default:!1}},emits:["click"],setup(s){return(c,f)=>(l(),g("div",{onClick:f[0]||(f[0]=i=>c.$emit("click")),class:"w-full relative cursor-pointer box-border"},[B(c.$slots,"default"),x("div",{class:V(["absolute flex items-center justify-center top-0 right-0 mr-sm mt-sm w-7 h-7 rounded-full border border-white",{"bg-indigo-500":s.active,"bg-black bg-opacity-20":!s.active}])},[s.active?(l(),M(ue,{key:0,class:"text-white"})):$("",!0)],2)]))}},ye={class:"relative flex flex-col justify-center"},_e={class:"text-sm text-gray-400 text-center"},he=["accept"],be={key:0,class:"mt-lg"},xe={__name:"UploadMedia",props:{maxSelection:{type:Number,default:1},combinesMimeTypes:{type:String,default:""},selected:{type:Array,default:[]},toggleSelect:{type:Function},isSelected:{type:Function},columns:{type:Number,default:3}},emits:["mediaSelect"],setup(s,{emit:c}){const f=s,i=E().props.mixpost.mime_types,k=_(null),d=_(!1),w=e=>{if(m.value)return;d.value=!1;const t=h(e.dataTransfer.files);t.length&&A(t)},S=e=>{const t=h(e.target.files);t.length&&(k.value.value=null,A(t))},h=e=>Array.from(e).filter(t=>i.includes(t.type)),m=_(!1),r=_([]),b=_([]),n=_({});q(n,()=>{C(),m.value=Object.keys(n.value).length>0});const C=()=>{n.value.handler&&n.value.handler()},u=e=>{r.value.push(e),Object.keys(n.value).length===0&&a()},a=e=>{Object.keys(n.value).length>0&&(J(n.value,e),f.toggleSelect&&f.toggleSelect(e)),r.value.length>0?(I(r.value[0]),j()):I({})},I=e=>{n.value=e},j=()=>{r.value.shift()},J=(e,t)=>{b.value.push(Object.assign(e,{media:t}))},A=e=>{e.forEach(t=>{u({id:pe(),handler:async()=>{await R(t).then(D=>{a(D)}).catch(D=>{a({name:t.name,error:D.response.data.message})})}})})},R=e=>{const t=new FormData;return t.append("file",e),new Promise((D,K)=>{axios.post(route("mixpost.media.upload"),t).then(function(Y){D(Y.data)}).catch(function(Y){K(Y)})})},y=U(()=>b.value.filter(()=>!0).reverse());return _([]),(e,t)=>(l(),g(T,null,[x("div",{onDragenter:t[2]||(t[2]=P(D=>d.value=!m.value,["prevent"])),onDrop:P(w,["prevent"]),onDragover:t[3]||(t[3]=P(()=>{},["prevent"])),class:V([{"border-gray-700 bg-white":!d.value,"border-cyan-500 bg-cyan-50":d.value},"relative w-full flex items-center justify-center rounded-lg p-10 border-2 border-dashed transition-colors ease-in-out duration-200"])},[x("div",ye,[d.value?(l(),g("div",{key:0,onDragleave:t[0]||(t[0]=P(D=>d.value=!1,["prevent"])),onDragover:t[1]||(t[1]=P(()=>{},["prevent"])),class:"w-full h-full absolute"},null,32)):$("",!0),p(ce,{class:V([{"text-stone-700":!d.value,"text-cyan-500":d.value},"!w-16 !h-16 mx-auto mb-xs transition-colors ease-in-out duration-200"])},null,8,["class"]),t[4]||(t[4]=x("div",{class:"text-center mb-1"},[N("Drag & drop files here, or "),x("label",{for:"browse",class:"cursor-pointer text-indigo-500 hover:text-indigo-700 active:text-indigo-700 focus:outline-none focus:text-indigo-700 transition-colors ease-in-out duration-200"}," Browse ")],-1)),x("div",_e,H(o(i).join(", ")),1)]),m.value?(l(),M(de,{key:0,size:"xl",class:"rounded-lg"})):$("",!0)],34),x("input",{ref_key:"input",ref:k,id:"browse",type:"file",accept:o(i).join(","),multiple:"multiple",class:"hidden",onChange:S},null,40,he),y.value.length?(l(),g("div",be,[p(z,{items:y.value,columns:s.columns},{default:v(({item:D})=>[p(G,{active:s.isSelected(D.media),onClick:K=>s.toggleSelect(D.media)},{default:v(()=>[p(L,{media:D.media},null,8,["media"])]),_:2},1032,["active","onClick"])]),_:1},8,["items","columns"])])):$("",!0)],64))}},ke={},we={class:"w-full text-lg"};function $e(s,c){return l(),g("div",we,[B(s.$slots,"default")])}const Se=Z(ke,[["render",$e]]),Ge={__name:"MediaUploads",props:{columns:{type:Number,default:3}},setup(s,{expose:c}){const{page:f,items:i,endlessPagination:k,selected:d,toggleSelect:w,deselectAll:S,removeItems:h,isSelected:m,createObserver:r}=W();return O(()=>{r()}),c({selected:d,deselectAll:S,removeItems:h}),(b,n)=>(l(),g(T,null,[p(xe,{"max-selection":4,"combines-mime-types":"",selected:o(d),toggleSelect:o(w),isSelected:o(m),columns:s.columns},null,8,["selected","toggleSelect","isSelected","columns"]),x("div",{class:V({"mt-lg":o(i).length})},[o(i).length?(l(),g(T,{key:0},[p(Se,{class:"mb-4"},{default:v(()=>n[0]||(n[0]=[N("Library")])),_:1}),p(z,{items:o(i),columns:s.columns},{default:v(({item:C})=>[C?(l(),M(G,{key:0,active:o(m)(C),onClick:u=>o(w)(C)},{default:v(()=>[p(L,{media:C},null,8,["media"])]),_:2},1032,["active","onClick"])):$("",!0)]),_:1},8,["items","columns"])],64)):$("",!0),x("div",{ref_key:"endlessPagination",ref:k,class:"-z-10 w-full"},null,512)],2)],64))}},Ce={},Ie={class:"absolute z-10 bottom-0 mb-xs left-0 ml-xs hidden group-hover:block shadow-mix"},Ne={class:"bg-white shadow-mix py-xs px-sm text-left rounded-md"};function De(s,c){return l(),g("div",Ie,[x("div",Ne,[B(s.$slots,"default")])])}const oe=Z(Ce,[["render",De]]),Te={key:0},Fe={key:0,class:"mt-lg"},Me=["href"],Pe=["href"],Je={__name:"MediaStock",props:{columns:{type:Number,default:3}},setup(s,{expose:c}){const f=U(()=>Q.snakeCase(E().props.app.name)),i=U(()=>E().props.is_configured_service.unsplash),{isLoaded:k,keyword:d,page:w,items:S,endlessPagination:h,selected:m,toggleSelect:r,deselectAll:b,isSelected:n,createObserver:C}=W("mixpost.media.fetchStock");return O(()=>{i.value&&C()}),c({selected:m,deselectAll:b}),(u,a)=>(l(),g(T,null,[i.value?(l(),g("div",Te,[p(le,{modelValue:o(d),"onUpdate:modelValue":a[0]||(a[0]=I=>ee(d)?d.value=I:null),placeholder:"Search Unsplash"},null,8,["modelValue"]),o(S).length?(l(),g("div",Fe,[p(z,{items:o(S),columns:s.columns},{default:v(({item:I})=>[I?(l(),M(G,{key:0,active:o(n)(I),onClick:j=>o(r)(I)},{default:v(()=>[p(L,{media:I,class:"group"},{default:v(()=>[p(oe,null,{default:v(()=>[x("div",null,[a[1]||(a[1]=N("Image from ")),x("a",{href:`https://unsplash.com/?utm_source=${f.value}&utm_medium=referral`,target:"_blank",class:"link"},"Unsplash",8,Me)]),x("div",null,[a[2]||(a[2]=N("By ")),x("a",{href:`${I.credit_url}?utm_source=${f.value}&utm_medium=referral`,target:"_blank",class:"link"},H(I.name),9,Pe)])]),_:2},1024)]),_:2},1032,["media"])]),_:2},1032,["active","onClick"])):$("",!0)]),_:1},8,["items","columns"])])):$("",!0),o(k)&&!o(S).length?(l(),M(ne,{key:1,class:"mt-lg"},{default:v(()=>a[3]||(a[3]=[N("No images found.")])),_:1})):$("",!0),x("div",{ref_key:"endlessPagination",ref:h,class:"-z-10 w-full"},null,512)])):$("",!0),i.value?$("",!0):(l(),g(T,{key:1},[p(ae,{variant:"warning",closeable:!1},{default:v(()=>a[4]||(a[4]=[N(" You have not configured Unsplash service. ")])),_:1}),p(o(se),{href:u.route("mixpost.services.index"),class:"block mt-md"},{default:v(()=>[p(te,null,{default:v(()=>a[5]||(a[5]=[N("Click to configure")])),_:1})]),_:1},8,["href"])],64))],64))}},Ue={key:0},Ve={key:0,class:"mt-lg"},Re={__name:"MediaGifs",props:{columns:{type:Number,default:3}},setup(s,{expose:c}){const f=U(()=>E().props.is_configured_service.tenor),{isLoaded:i,keyword:k,page:d,items:w,endlessPagination:S,selected:h,toggleSelect:m,deselectAll:r,isSelected:b,createObserver:n}=W("mixpost.media.fetchGifs");return O(()=>{f.value&&n()}),c({selected:h,deselectAll:r}),(C,u)=>(l(),g(T,null,[f.value?(l(),g("div",Ue,[p(le,{modelValue:o(k),"onUpdate:modelValue":u[0]||(u[0]=a=>ee(k)?k.value=a:null),placeholder:"Search Tenor GIFs"},null,8,["modelValue"]),o(w).length?(l(),g("div",Ve,[p(z,{items:o(w),columns:s.columns},{default:v(({item:a})=>[a?(l(),M(G,{key:0,active:o(b)(a),onClick:I=>o(m)(a)},{default:v(()=>[(l(),M(L,{media:a,key:a.id,class:"group"},{default:v(()=>[p(oe,null,{default:v(()=>u[1]||(u[1]=[N(" GIF from Tenor ")])),_:1})]),_:2},1032,["media"]))]),_:2},1032,["active","onClick"])):$("",!0)]),_:1},8,["items","columns"])])):$("",!0),o(i)&&!o(w).length?(l(),M(ne,{key:1,class:"mt-lg"},{default:v(()=>u[2]||(u[2]=[N("No GIFs found.")])),_:1})):$("",!0),x("div",{ref_key:"endlessPagination",ref:S,class:"-z-10 w-full"},null,512)])):$("",!0),f.value?$("",!0):(l(),g(T,{key:1},[p(ae,{variant:"warning",closeable:!1},{default:v(()=>u[3]||(u[3]=[N(" You have not configured Tenor service. ")])),_:1}),p(o(se),{href:C.route("mixpost.services.index"),class:"block mt-md"},{default:v(()=>[p(te,null,{default:v(()=>u[4]||(u[4]=[N("Click to configure")])),_:1})]),_:1},8,["href"])],64))],64))}};export{Ge as _,Je as a,Re as b,W as u};
